###간단한 ARIMA modeling


abc2_cast<-cast(abc2, date~id, value = "usage1")
colnames(abc2_cast)<-c('date','a','b')


excess_frac<- (abc2_cast$b - abc2_cast$a)/abc2_cast$a
excess_ts <- ts(excess_frac, frequency = 365, start = abc2_cast$date[1])
autoplot(excess_ts)


par(mfrow=c(1,2))
acf(excess_ts)
pacf(excess_ts)
summary(lm(excess_ts ~ 1))


##관련패키지 실해

library(astsa)
library(lmtest)
library(FitARMA)
library(fBasics)
library(strucchange)


##modeling

break_point <- breakpoints(excess_ts ~ 1)
plot(break_point)
summary(break_point)

plot(excess_ts)
lines(fitted(break_point, breaks = 2), col = 4)
lines(confint(break_point, breaks = 2))


model1 <- auto.arima(excess_ts, stepwise = FALSE, trace = TRUE)

summary(model1)
coeftest(model1)
checkresiduals(model1)
sarima(excess_ts, p = 1, d = 1, q = 1)


